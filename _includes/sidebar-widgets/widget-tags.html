{% if site.tags.size > 0 %}
{% assign content_language = page.lang | default: site.lang | default: "en" %}
{% assign base_language = content_language | split: "-" | first | downcase %}
{% assign t = site.data.translations[base_language] | default: site.data.translations.en %}
{% assign rtl_languages = "ar,arc,ckb,dv,fa,he,khw,ks,ku,ps,sd,ug,ur,yi" | split: "," %}
{% assign content_direction = "ltr" %}
{% if rtl_languages contains base_language %}
  {% assign content_direction = "rtl" %}
{% endif %}

<div class="widget widget-tags" lang="{{ content_language }}" dir="{{ content_direction }}">
  <div class="widget-sidebar-head">
    <h2 class="widget-sidebar-title">{{ t.topics_label }}</h2>
  </div>

  <div class="tag-cloud">
    {% for tag in site.tags %}
      {% assign tag_name = tag[0] %}
      {% assign tag_posts = tag[1] %}
      {% assign tag_color = 'var(--dark-gray)' %}

      {% for post in tag_posts %}
        {% if tag_color == 'var(--dark-gray)' %}
          {% assign tag_color = post.tags_color | default: tag_color %}
        {% endif %}
      {% endfor %}

      <a href="{{ site.baseurl }}/tags/?tag={{ tag_name | downcase | url_encode }}"
         class="tag-cloud__item"
        style="--tag-accent: {{ tag_color }};">
        {{ tag_name }}
      </a>
    {% endfor %}
  </div>
</div>
{% endif %}